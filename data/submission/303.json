{"submission_id": "303", "source": "#include <iostream>\r\n#include <map>\r\n#include <vector>\r\n#include <algorithm>\r\n\r\nusing namespace std;\r\n\r\ntypedef pair<int, int> pt;\r\n\r\nconst int INF = 1000000000;\r\n\r\nint M, N, K;\r\nchar field[64][64];\r\n\r\nstruct state {\r\n\tint x, y, k;\r\n\tvector<pt> visited;\r\n\r\n\tstate(int x, int y, int k, vector<pt> v)\r\n\t\t: x(x), y(y), k(k), visited(v) { }\r\n\r\n\tbool operator < (const state& o) const {\r\n\t\treturn \r\n\t\t\tmake_pair(pt(x, y),     make_pair(k, visited)) <\r\n\t\t\tmake_pair(pt(o.x, o.y), make_pair(o.k, o.visited));\r\n\t}\r\n};\r\n\r\nmap<state, int> memo;\r\n\r\nint solve(int cur_x, int cur_y, int k, vector<pt> visited)\r\n{\r\n\tstate cur(cur_x, cur_y, k, visited);\r\n\r\n\tif (memo.find(cur) != memo.end()) {\r\n\t\treturn memo[cur];\r\n\t}\r\n\r\n\tint res = -INF;\r\n\r\n\tif (cur_x == M-1 && cur_y == N-1) {\r\n\t\tres = 0;\r\n\t}\r\n\r\n\tconst static int dx[] = {1, 0, -1, 0};\r\n\tconst static int dy[] = {0, 1, 0, -1};\r\n\t\r\n\tfor (int d = 0; d < 4; ++d) {\r\n\t\tint xx = cur_x + dx[d];\r\n\t\tint yy = cur_y + dy[d];\r\n\t\tint kk = k - (d >= 2 ? 1 : 0);\r\n\r\n\t\tif (xx < 0 || yy < 0 || xx >= M || yy >= N || kk < 0 || field[xx][yy] == '#') {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tvector<pt> vv;\r\n\r\n\t\tfor (int i = 0; i < (int)visited.size(); ++i) {\r\n\t\t\tif (max(xx - visited[i].first, 0) + max(yy - visited[i].second, 0) <= kk) {\r\n\t\t\t\tvv.push_back(visited[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (field[xx][yy] != '.') {\r\n\t\t\tvv.push_back(pt(xx, yy));\r\n\t\t\tsort(vv.begin(), vv.end());\r\n\t\t\tvv.erase(unique(vv.begin(), vv.end()), vv.end());\r\n\t\t}\r\n\r\n\t\tint val = (field[xx][yy] != '.' ? field[xx][yy] - '0' : 0);\r\n\t\tfor (int i = 0; i < (int)visited.size(); ++i) {\r\n\t\t\tif (visited[i] == pt(xx, yy)) {\r\n\t\t\t\tval = 0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tres = max(res, solve(xx, yy, kk, vv) + val);\r\n\t}\r\n\r\n\treturn memo[cur] = res;\r\n}\r\n\r\nint main()\r\n{\r\n\tcin >> M >> N >> K;\r\n\r\n\tfor (int i = 0; i < M; ++i) {\r\n\t\tcin >> field[i];\r\n\t}\r\n\r\n\tcout << solve(0, 0, K, vector<pt>()) << endl;\r\n\r\n\treturn 0;\r\n}", "problem_id": "48", "problem_title": "\u8ca1\u5b9d (Treasures)", "datetime": "2018-07-30 22:31:09", "lang": "C++", "user": "taiki_okano", "sample_io": ["TimeLimitExceeded", "WrongAnswer"], "result": "RuntimeError", "testcase": [{"result": "RuntimeError", "max_score": "20", "io_result": ["RuntimeError"]}, {"result": "WrongAnswer", "max_score": "20", "io_result": ["WrongAnswer"]}, {"result": "RuntimeError", "max_score": "20", "io_result": ["RuntimeError"]}, {"result": "RuntimeError", "max_score": "20", "io_result": ["RuntimeError"]}, {"result": "RuntimeError", "max_score": "20", "io_result": ["RuntimeError"]}], "score": "0", "max_score": "100"}