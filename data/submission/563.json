{"submission_id": "563", "source": "#include <iostream>\r\n#include <array>\r\n\r\nconstexpr int MAX_K=100;\r\n\r\nusing ll=long long int;\r\n\r\nconstexpr ll mod=(int)1e9+7;\r\n\r\nusing Mat=std::array<ll,MAX_K>;\r\nusing Base=std::array<std::array<ll,MAX_K>,MAX_K>;\r\n\r\nBase pow_base;\r\nMat ini;\r\n\r\nll m;\r\nint k;\r\n\r\nvoid init() {\r\n    for(auto&& x : ini) x=1;\r\n    for(auto&& row : pow_base)\r\n        for(auto&& x : row) x=0;\r\n    for(int i=0;i<k;++i)\r\n        pow_base[0][i]=1;\r\n    for(int i=1;i<k;++i){\r\n        pow_base[i][i-1]=1;\r\n    }\r\n}\r\n\r\nMat pow(const Mat& mat,const Base& powB) {\r\n\r\n    Mat ret;\r\n\r\n    for(int i=0;i<k;++i)\r\n        ret[i]=0;\r\n\r\n    for(int i=0;i<k;++i){\r\n        for(int j=0;j<k;++j){\r\n            ret[i]+=mat[j]*powB[i][j];\r\n            ret[i]%=mod;\r\n        }\r\n    }\r\n\r\n    return ret;\r\n}\r\n\r\nBase pow(const Base& pow1,const Base& pow2){\r\n\r\n    Base powR;\r\n    for(int i=0;i<k;++i){\r\n        for(int j=0;j<k;++j)\r\n            powR[i][j]=0;\r\n    }\r\n\r\n    for(int i=0;i<k;++i){\r\n        for(int j=0;j<k;++j){\r\n            int a=0;\r\n            for(int l=0;l<k;++l){\r\n                powR[i][j]+=pow1[i][l]*pow2[l][j];\r\n                powR[i][j]%=mod;\r\n            }\r\n        }\r\n    }\r\n\r\n    return powR;\r\n}\r\n\r\nMat solve() {\r\n    ll cnt=m-(ll)k;\r\n    if(cnt<=0)\r\n        return ini;\r\n\r\n    Mat ret=ini;\r\n    Base x=pow_base;\r\n\r\n    for(ll i=1;i<=cnt;i*=2){\r\n        if(cnt&i){\r\n            ret=pow(ret,x);\r\n        }\r\n        x=pow(x,x);\r\n    }\r\n\r\n    return ret;\r\n}\r\n\r\nint main() {\r\n\r\n    std::cin>>k>>m;\r\n\r\n    init();\r\n\r\n    Mat res=solve();\r\n\r\n    std::cout<<res[0]%mod<<std::endl;\r\n\r\n    return 0;\r\n}", "problem_id": "76", "problem_title": "\u590f\u4f11\u307f\u7de8Part2", "datetime": "2018-08-05 13:26:21", "lang": "C++", "user": "ikasmith", "sample_io": ["Accepted", "Accepted"], "testcase": [{"result": "Accepted", "max_score": "10", "io_result": ["Accepted", "Accepted", "Accepted", "Accepted"]}, {"result": "WrongAnswer", "max_score": "20", "io_result": ["WrongAnswer", "Accepted", "Accepted"]}, {"result": "Accepted", "max_score": "70", "io_result": ["Accepted", "Accepted", "Accepted"]}], "result": "WrongAnswer", "score": "80", "max_score": "100"}