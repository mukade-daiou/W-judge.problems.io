{"submission_id": "306", "source": "#include<cstdio>\r\n#include<algorithm>\r\n#include<vector>\r\n#include<deque>\r\n#include<stack>\r\n#include<queue>\r\n#include<string>\r\n#include<iostream>\r\n#include<tuple>\r\n#include<utility>\r\n#include<set>\r\n#include<queue>\r\n#include<iomanip>\r\n#include<iterator>\r\n#include<map>\r\n#include<bitset>\r\n#include<array>\r\n#include<cmath>\r\n//#include<chrono>\r\n//cout<<setprecision(12)\r\n//fixed\r\n//#include<random>\r\n//14348907\r\nusing namespace std;\r\ntypedef long long int llint;\r\ntypedef long double lldo;\r\nconst llint big=1e9+100000;\r\nconst llint mod=1e9+7;\r\nconst lldo eps=1e-7;\r\nconst long double pai=3.141592653589793238462643;\r\n#define mt make_tuple\r\n#define mp make_pair\r\n#define fir first\r\n#define sec second\r\n#define pub push_back\r\n#define puf push_front\r\n#define pob pop_back\r\n#define pof pop_front\r\n#define res resize\r\n#define ins insert\r\n#define era erase\r\n#define dme(in) cout<<in<<endl;return 0\r\ntemplate <class T,class U>void mineq(T& a,U b){if(a>b){a=b;}}\r\ntemplate <class T,class U>void maxeq(T& a,U b){if(a<b){a=b;}}\r\nint main(void){\r\n    ios::sync_with_stdio(false);\r\n    llint n,d;cin>>n>>d;\r\n    llint i,j;\r\n    static pair<llint,llint>mae[14348907];//????????\u00a8??????\r\n    static pair<llint,llint>ato[14348907];//????????\u00a8?????? pair<?????\u00b4??????,??\u00b4??????>\r\n    llint maesu=1,atosu=1;\r\n    mae[0]=mp(0LL,0LL);\r\n    ato[0]=mp(0LL,0LL);\r\n    for(i=0;i<n/2;i++){\r\n        llint x,y;\r\n        cin>>x>>y;\r\n        for(j=0;j<maesu;j++){\r\n            mae[j+maesu]=mp(mae[j].fir+x,mae[j].sec+y);\r\n            mae[j+maesu+maesu]=mp(mae[j].fir-x,mae[j].sec-y);\r\n        }\r\n        maesu*=3;\r\n    }\r\n    for(i=n/2;i<n;i++){\r\n        llint x,y;\r\n        cin>>x>>y;\r\n        for(j=0;j<atosu;j++){\r\n            ato[j+atosu]=mp(ato[j].fir+x,ato[j].sec+y);\r\n            ato[j+atosu+atosu]=mp(ato[j].fir-x,ato[j].sec-y);\r\n        }\r\n        atosu*=3;\r\n    }\r\n    sort(mae,mae+maesu);\r\n    sort(ato,ato+atosu);\r\n    deque<pair<llint,llint>> que;//????????????????\u00b0?????????????,\r\n    llint dco=0;\r\n    llint ans=0;\r\n    for(i=0;i<maesu;i++){\r\n        llint ki=mae[i].fir;\r\n        llint ka=mae[i].sec;\r\n        //ki-d<=??????<=ki+d\r\n        //ka-(que???????\u00b0?) ????????\u00a7???\r\n        while(dco<atosu&&ato[dco].fir<=ki+d){\r\n            while((!que.empty())&&que.back().sec>=ato[dco].sec){que.pob();}\r\n            que.pub(ato[dco]);\r\n            dco++;\r\n        }\r\n        while((!que.empty())&&que.front().fir<ki-d){que.pof();}\r\n        if(!que.empty()){maxeq(ans,ka-que.front().sec);}\r\n    }\r\n    cout<<ans<<endl;\r\n    return 0;\r\n}", "problem_id": "48", "problem_title": "\u8ca1\u5b9d (Treasures)", "datetime": "2018-07-30 22:40:14", "lang": "C++", "user": "taiki_okano", "sample_io": ["Accepted", "Accepted"], "testcase": [{"result": "Accepted", "max_score": "20", "io_result": ["Accepted"]}, {"result": "TimeLimitExceeded", "max_score": "20", "io_result": ["TimeLimitExceeded"]}, {"result": "Accepted", "max_score": "20", "io_result": ["Accepted"]}, {"result": "WrongAnswer", "max_score": "20", "io_result": ["WrongAnswer"]}, {"result": "Accepted", "max_score": "20", "io_result": ["Accepted"]}], "result": "WrongAnswer", "score": "60", "max_score": "100"}