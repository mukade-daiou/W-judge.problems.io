{"submission_id": "2291", "source": "# include <iostream>\r\n# include <algorithm>\r\n# include <vector>\r\n# include <string>\r\n# include <set>\r\n# include <map>\r\n# include <cmath>\r\n# include <iomanip>\r\n# include <functional>\r\n# include <utility>\r\n# include <stack>\r\n# include <queue>\r\n# include <list>\r\n# include <bitset>\r\n# include <complex>\r\n#include<limits.h>\r\n#include<random>\r\n#include<deque>\r\n#include<cstdio>\r\n#include<fstream>\r\nusing namespace std;\r\ntypedef long long ll;\r\ntypedef unsigned long long ull;\r\nconst int N = 2000100;\r\nconst int MOD = (int)pow(10, 9) + 7;\r\nconst ll INF = 1LL << 60;\r\n#define rep(i,n) for(ll i=(ll)0;i<(ll)n;++i)\r\n#define ALL(x) x.begin(),x.end()\r\n#define pp pair<ll,ll>\r\n#define ppp pair<ll,pp>\r\n#define pps pair<string ,ll>\r\n#define fi first\r\n#define se second\r\n#define pb push_back\r\n#define fix(n) fixed<<setprecision(n)\r\n#define itr vector<ll>::iterator\r\n#define print(s) cout<<s<<endl\r\n#define inp(s) cin>>s\r\nstring yn(bool b) { return (b ? \"Yes\" : \"No\"); }\r\nstring YN(bool b) { return (b ? \"YES\" : \"NO\"); }\r\nstruct edge { ll to, cost; };\r\nll n, m;\r\n// \u2191cost\u3068\u9802\u70b9\u756a\u53f7\u306e\u30da\u30a2\r\nstruct DIJX5 {\r\n\tll V;\r\n\tvector<edge> lists[100100];\r\n\tll d[100100][5];\r\n\tvoid dijx(ll st) {\r\n\t\trep(i, 100100)rep(j,5)d[i][j] = INF; // std::fill\u3067\u3082\u66f8\u3051\u308b\r\n\t\td[st][0] = 0; // \u59cb\u70b9\r\n\t\tpriority_queue<ppp, vector<ppp>, greater<ppp>> pq;\r\n\t\tpq.push(ppp{ d[st][0], pp{st,0}}); // (cost,\u9802\u70b9\u756a\u53f7)\r\n\t\twhile (!pq.empty()) {\r\n\t\t\tppp p = pq.top();\r\n\t\t\tpq.pop();\r\n\t\t\tll i = p.se.fi,mod=p.se.se; // cost\u304cfirst\u3001\u9802\u70b9\u756a\u53f7\u304cse.fi \u4f59\u308a\u304cse.se\r\n\t\t\tif (i == n - 1)continue;\r\n\t\t\tif (d[i][mod]<p.first)continue;\r\n\t\t\trep(k, lists[i].size()) {\r\n\t\t\t\tedge e = lists[i][k];\r\n\t\t\t\tif (d[e.to][(mod+e.cost)%5] <= d[i][mod] + e.cost)continue;\r\n\t\t\t\td[e.to][(mod+e.cost)%5] = d[i][mod] + e.cost;\r\n\t\t\t\tpq.push(ppp{ d[e.to][(mod+e.cost)%5],pp{ e.to,(mod + e.cost) % 5 } });\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\nstruct DIJX13 {\r\n\tll V;\r\n\tvector<edge> lists[100100];\r\n\tll d[100100][13];\r\n\tvoid dijx(ll st) {\r\n\t\trep(i, 100100)rep(j, 13)d[i][j] = INF; // std::fill\u3067\u3082\u66f8\u3051\u308b\r\n\t\td[st][0] = 0; // \u59cb\u70b9\r\n\t\tpriority_queue<ppp, vector<ppp>, greater<ppp>> pq;\r\n\t\tpq.push(ppp{ d[st][0], pp{ st,0 } }); // (cost,\u9802\u70b9\u756a\u53f7)\r\n\t\twhile (!pq.empty()) {\r\n\t\t\tppp p = pq.top();\r\n\t\t\tpq.pop();\r\n\t\t\tll i = p.se.fi, mod = p.se.se; // cost\u304cfirst\u3001\u9802\u70b9\u756a\u53f7\u304cse.fi \u4f59\u308a\u304cse.se\r\n\t\t\tif (i == n - 1)continue;\r\n\t\t\tif (d[i][mod]<p.first)continue;\r\n\t\t\trep(k, lists[i].size()) {\r\n\t\t\t\tedge e = lists[i][k];\r\n\t\t\t\tif (d[e.to][(mod + e.cost) % 13] <= d[i][mod] + e.cost)continue;\r\n\t\t\t\td[e.to][(mod + e.cost) % 13] = d[i][mod] + e.cost;\r\n\t\t\t\tpq.push(ppp{ d[e.to][(mod + e.cost) % 13],pp{ e.to,(mod + e.cost) % 13 } });\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\nDIJX5 d;\r\nDIJX13 d2;\r\nint main() {\r\n\tcin >> n>>m;\r\n\tll f, t, c;\r\n\trep(i, m) {\r\n\t\tcin >> f >> t >> c;\r\n\t\td.lists[f].pb(edge{t,c});\r\n\t\td.lists[t].pb(edge{ f,c });\r\n\t\td2.lists[f].pb(edge{ t,c });\r\n\t\td2.lists[t].pb(edge{ f,c });\r\n\t}\r\n\td.dijx(0);\r\n\td2.dijx(0);\r\n\tcout << min(d2.d[n-1][0],d.d[n-1][0]) << endl;\r\n\treturn 0;\r\n}", "problem_id": "110", "problem_title": "(400)\u3053\u3046\u305d\u304f\u3044\u3069\u3046\u306e\u795e\u3001akusyounin!", "datetime": "2018-08-25 14:56:40", "lang": "C++", "user": "mukadenodaiou", "sample_io": ["Accepted"], "testcase": [{"result": "Accepted", "max_score": "400", "io_result": ["Accepted", "Accepted", "Accepted", "Accepted", "Accepted", "Accepted"]}], "result": "Accepted", "score": "400", "max_score": "400"}